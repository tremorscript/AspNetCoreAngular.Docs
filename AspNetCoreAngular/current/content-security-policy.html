<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Content Security Policy :: AspNetCoreAngular Developer Documentation</title>
    <link rel="canonical" href="https://tremorscript.com/AspNetCoreAngular/current/content-security-policy.html">
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://tremorscript.com">AspNetCoreAngular Developer Documentation</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs" >
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="AspNetCoreAngular" data-version="1.0.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="index.html">AspNetCoreAngular</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="getting-started.html">Getting Started</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="code-quality-guidelines.html">Code Quality Guidelines</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="pull-request-guidelines.html">Pull Request Guidelines</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="content-security-policy.html">Content Security Policy</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="authorization.html">Authentication and Authorization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="configuration-management.html">Configuration Management</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="error-handling.html">Error Handling and Logging</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="internationalization.html">Internationalization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="unit-testing.html">Performance Testing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="functional-testing.html">Functional Testing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="e2e-testing.html">End-to-End Testing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="property-based-testing.html">Property Based Testing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="performance-testing.html">Performance Testing</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="owasp-top10.html">OWASP Top 10</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="threat-modeling.html">Threat Modeling</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="api-versioning.html">Api Versioning Policy</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="release-policy.html">Release Policy</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">AspNetCoreAngular</span>
    <span class="version">1.0.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="index.html">AspNetCoreAngular</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">1.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">AspNetCoreAngular</a></li>
    <li><a href="content-security-policy.html">Content Security Policy</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="https://github.com/tremorscript/AspNetCoreAngular.Docs/edit/main/modules/ROOT/pages/content-security-policy.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="4">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Content Security Policy</h1>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Content Security Policy is delivered via a HTTP response header, much like HSTS, and defines approved sources of content that the browser may load.</p>
</div>
<div class="paragraph">
<p>A CSP header allows you to define approved sources for content on your site that the browser can load.</p>
</div>
<div class="paragraph">
<p>By specifying only those sources that you wish the browser to load content from, you can protect your visitors from a whole range of issues.</p>
</div>
<div class="paragraph">
<p>Here is a basic CSP response header:-</p>
</div>
<div class="paragraph">
<p><code>Content-Security-Policy: script-src 'self'</code></p>
</div>
<div class="paragraph">
<p>The <code>script-src</code> directive specifies the whitelist of sources that the browser may load scripts from.</p>
</div>
<div class="paragraph">
<p><code>self</code> is a keyword which specifies the current domain.</p>
</div>
<div class="paragraph">
<p>So the browser will only load script files from the current domain.</p>
</div>
<div class="paragraph">
<p>There are other directives and keywords that can be used.</p>
</div>
<div class="paragraph">
<p>These headers only apply to responses that return one of the following content-types:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>text/html</code></p>
</li>
<li>
<p><code>text/javascript</code></p>
</li>
<li>
<p><code>application/javascript</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_security_headers"><a class="anchor" href="#_security_headers"></a>Security Headers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Content Security Policy headers are added using the <code>SecurityHeaderMiddleWare</code> class.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>AddFrameOptionsDeny</code></p>
<div class="ulist">
<ul>
<li>
<p>Adds <code>X-Frame-Options: Deny</code> header to the response.</p>
</li>
<li>
<p>The page cannot be displayed in a frame, regardless of the site attempting to do so.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>AddXssProtectionBlock</code></p>
<div class="ulist">
<ul>
<li>
<p>Adds <code>X-XSS-Protection: 1; mode=block</code> header to the response.</p>
</li>
<li>
<p>Enables XSS protections and instructs the user-agent to block the response in the event that script has been inserted from user input, instead of sanitizing.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>AddContentTypeOptionsNoSniff</code></p>
<div class="ulist">
<ul>
<li>
<p>Adds <code>X-Content-Type-Options: nosniff</code> header to the response.</p>
</li>
<li>
<p>Disables content sniffing.</p>
</li>
<li>
<p>Can be set to protect against MIME type confusion attacks.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>AddStrictTransportSecurityMaxAge</code></p>
<div class="ulist">
<ul>
<li>
<p>Adds <code>Strict-Transport-Security: max-age=31536000; includeSubDomains</code> header to the response.</p>
</li>
<li>
<p>Tells the user-agent to cache the domain in the STS list for the number of seconds provided.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>AddReferrerPolicyOriginWhenCrossOrigin</code></p>
<div class="ulist">
<ul>
<li>
<p>Adds <code>Referrer-Policy: strict-origin-when-cross-origin</code> header to the response.</p>
</li>
<li>
<p>The browser will send the full URL to requests to the same origin but only send the origin when requests are cross-origin.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>RemoveServerHeader</code></p>
<div class="ulist">
<ul>
<li>
<p>Removes the Server header from all responses.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_content_security_policy_headers"><a class="anchor" href="#_content_security_policy_headers"></a>Content Security Policy Headers</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">builder.AddDefaultSrc().Self();</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AddDefaultSrc</code> - The <code>default-src</code> directive serves as a fallback for the other CSP fetch directives.</p>
</li>
<li>
<p>Self - Allow sources from the origin from which the protected document is being served, including the same URL scheme and port number.</p>
</li>
</ul>
</div>
</li>
<li>
<p></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">builder.AddConnectSrc().Self().From(stsUrl).From(socketUrl);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AddConnectSrc</code> - The <code>connect-src</code> directive restricts the URLs which can be loaded using script interfaces The APIs that are restricted are: <code>&lt;a&gt;</code>, <code>ping</code>, <code>Fetch</code>, <code>XMLHttpRequest</code>, <code>WebSocket</code>, and <code>EventSource</code>.</p>
</li>
<li>
<p><code>Self</code> - Allow sources from the origin from which the protected document is being served, including the same URL scheme and port number.</p>
</li>
<li>
<p><code>From</code> - Allow resources from the given uri. May be any non-empty value. In this case, we add the host url and the sts url to the list.</p>
</li>
</ul>
</div>
</li>
<li>
<p></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">builder
    .AddFontSrc() // font-src 'self'
    .Self()
    .Data();</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AddFontSrc</code> - The <code>font-src</code> directive specifies valid sources for fonts loaded using @font-face.</p>
</li>
<li>
<p><code>Self</code> - Allow sources from the origin from which the protected document is being served, including the same URL scheme and port number.</p>
</li>
<li>
<p><code>Data</code> - data: Allows data: URIs to be used as a content source.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This is insecure; an attacker can also inject arbitrary data. Use this sparingly and definitely not for scripts.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">builder
    .AddObjectSrc() // object-src 'none'
    .None();</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AddObjectSrc</code> - The <code>object-src</code> directive specifies valid sources for the <code>&lt;object&gt;</code>, <code>&lt;embed&gt;</code>, and <code>&lt;applet&gt;</code> elements.</p>
</li>
<li>
<p><code>None</code> - Block the resource (Refers to the empty set; that is, no URLs match)</p>
</li>
</ul>
</div>
</li>
<li>
<p></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">builder
    .AddFormAction() // form-action 'self'
    .Self();</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AddFormAction</code> - The <code>font-src</code> directive specifies valid sources for fonts loaded using @font-face.</p>
</li>
<li>
<p><code>Self</code> - Allow sources from the origin from which the protected document is being served, including the same URL scheme and port number.</p>
</li>
</ul>
</div>
</li>
<li>
<p></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">builder
    .AddImgSrc() // img-src https:
    .Self()
    .Data();</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AddImgSrc</code> - The <code>img-src</code> directive specifies valid sources of images and favicons.</p>
</li>
<li>
<p><code>Self</code> - Allow sources from the origin from which the protected document is being served, including the same URL scheme and port number.</p>
</li>
<li>
<p><code>Data</code> - data: Allows data: URIs to be used as a content source.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This is insecure; an attacker can also inject arbitrary data: URIs. Use this sparingly and definitely not for scripts.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">builder.AddCustomDirective("script-src","'self' 'unsafe-inline' 'unsafe-eval'");
builder.AddCustomDirective("style-src", "'self' 'unsafe-inline' 'unsafe-eval'");
builder.AddCustomDirective("style-src", "'self' 'unsafe-inline' 'unsafe-eval'");</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>script-src</code> - The script-src directive specifies valid sources for sources for JavaScript.</p>
</li>
<li>
<p><code>style-src</code> - The style-src directive specifies valid sources for sources for stylesheets.</p>
</li>
<li>
<p><code>Self</code> - Allow sources from the origin from which the protected document is being served, including the same URL scheme and port number.</p>
</li>
<li>
<p><code>UnsafeInline</code> - Allows the use of inline resources, such as inline <code>&lt;script&gt;</code> elements, inline event handlers, and inline <code>&lt;style&gt;</code> elements.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This source is insecure - you should not use this directive if at all possible.
</td>
</tr>
</table>
</div>
</li>
<li>
<p><code>UnsafeEval</code> - Allows the use of eval() and similar methods for creating code from strings.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This source is insecure - you should not use this directive if at all possible.
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">builder.AddUpgradeInsecureRequests();</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>upgrade-insecure-requests</code> directive instructs user agents to treat all of a site’s insecure URLs (those served over HTTP) as though they have been replaced with secure URLs (those served over HTTPS).</p>
</li>
<li>
<p>This directive is intended for websites with large numbers of insecure legacy URLs that need to be rewritten.</p>
</li>
</ul>
</div>
</li>
<li>
<p></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">builder.AddMediaSrc().Self();</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AddMediaSrc</code> - The <code>media-src</code> directive specifies valid sources for loading media using the <code>&lt;audio&gt;</code> and <code>&lt;video&gt;</code> elements.</p>
</li>
<li>
<p><code>Self</code> - Allow sources from the origin from which the protected document is being served, including the same URL scheme and port number.</p>
</li>
</ul>
</div>
</li>
<li>
<p></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">builder.AddFrameAncestors().None();</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AddFrameAncestors</code> - The <code>frame-ancestors</code> directive specifies valid parents that may embed a page using <code>&lt;frame&gt;</code>, <code>&lt;iframe&gt;</code>, <code>&lt;object&gt;</code>, <code>&lt;embed&gt;</code>, or <code>&lt;applet&gt;</code>.</p>
</li>
<li>
<p>Setting this directive to <code>none</code> is similar to <code>X-Frame-Options: DENY</code> (which is also supported in older browsers).</p>
</li>
</ul>
</div>
</li>
<li>
<p></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-csharp hljs" data-lang="csharp">builder.AddFrameSrc().From(stsUrl);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AddFrameSrc</code> - The <code>frame-src</code> directive specifies valid sources for nested browsing contexts loading using elements such as <code>&lt;frame&gt;</code> and <code>&lt;iframe&gt;</code>.</p>
</li>
<li>
<p><code>From</code> - Allow resources from the given uri. May be any non-empty value.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references"><a class="anchor" href="#_references"></a>References</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/andrewlock/NetEscapades.AspNetCore.SecurityHeaders" target="_blank" rel="noopener">NetEscapades.AspNetCore.SecurityHeaders</a></p>
</li>
<li>
<p><a href="https://scotthelme.co.uk/content-security-policy-an-introduction/" target="_blank" rel="noopener">Content Security Policy</a></p>
</li>
<li>
<p><a href="https://scotthelme.co.uk/csp-cheat-sheet/?ref=scotthelme.co.uk" target="_blank" rel="noopener">CSP Cheatsheet</a></p>
</li>
<li>
<p><a href="https://scotthelme.co.uk/goodbye-feature-policy-and-hello-permissions-policy/" target="_blank" rel="noopener">Permissions Policy</a></p>
</li>
</ul>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script src="../../_/js/vendor/lunr.js"></script>
<script src="../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../.." data-snippet-length="100" data-stylesheet="../../_/css/search.css"></script>
<script async src="../../search-index.js"></script>
  </body>
</html>
